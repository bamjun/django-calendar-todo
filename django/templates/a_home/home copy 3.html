{% extends "layouts/blank.html" %} {% block content %}

<!-- <div class="max-w-4xl mx-auto px-8 py-24">
        <h1>New Project</h1>
    </div> -->

<style>
  .sidebar a {
    padding: 10px 15px; /* ë§í¬ íŒ¨ë”© */
    text-decoration: none; /* ë§í¬ ë°‘ì¤„ ì œê±° */
    font-size: 18px; /* í°íŠ¸ í¬ê¸° */
    color: white; /* í°íŠ¸ ìƒ‰ìƒ */
    display: block; /* ë¸”ë¡ ë ˆë²¨ ìš”ì†Œë¡œ í‘œì‹œ */
  }

  .sidebar a:hover {
    color: #000000; /* í˜¸ë²„ ì‹œ ìƒ‰ìƒ ë³€ê²½ */
  }

  .layout {
    display: flex; /* flexbox ë ˆì´ì•„ì›ƒ ì‚¬ìš© */
  }

  .sidebar {
    padding-left: 3px;
    width: 150px; /* ì‚¬ì´ë“œë°”ì˜ ê³ ì • ë„“ì´ */
    /* ê¸°ì¡´ ì‚¬ì´ë“œë°” ìŠ¤íƒ€ì¼ */
    color: white;
  }

  #calendar {
    flex-grow: 1; /* ë‚¨ì€ ê³µê°„ì„ ëª¨ë‘ ì±„ì›€ */
    /* ë†’ì´ ì„¤ì • ìœ ì§€ */
  }

  .layout {
    display: flex; /* flexbox ë ˆì´ì•„ì›ƒ ì‚¬ìš© */
    /* flex-direction: column;  ì„¸ë¡œ ë°©í–¥ìœ¼ë¡œ ìš”ì†Œ ì •ë ¬ */
    height: calc(100vh - 5rem); /* í—¤ë” ë†’ì´ë¥¼ ì œì™¸í•œ ì „ì²´ ë†’ì´ */
    overflow: auto; /* ë‚´ìš©ì´ ë ˆì´ì•„ì›ƒì„ ì´ˆê³¼í•  ê²½ìš° ìŠ¤í¬ë¡¤ë°” í‘œì‹œ */
  }
  .btn-updown {
    font-size: 12px;
  }
</style>

<div class="layout">
  <div class="sidebar bg-blue-400">
    <ul>
      <li id="view_today" style="text-align: center">2024-04-07</li>
      <li><a href="#">ğŸ”µ Todo</a></li>
      <li><a href="#">ğŸŸ¢ ì™„ë£Œ</a></li>
      <li><a href="#">ğŸŸ  ì§„í–‰ì¤‘</a></li>
      <li><a id="monthly" href="#">ì›”ë³„</a></li>
      <li><a id="weekly" href="#">ì£¼ë³„</a></li>
      <li><a id="daily" href="#">ì¼ë³„</a></li>
      <li>
        <button class="btn-updown" id="date_previous">â—€ï¸</button>
        <button class="btn-updown" id="date_next">â–¶ï¸</button>
      </li>
    </ul>
  </div>
  <div id="calendar"></div>
</div>

<!-- CDNê³¼ ë¸Œë¼ìš°ì € í™˜ê²½ì—ì„œ namespace -->
<link
  rel="stylesheet"
  href="https://uicdn.toast.com/calendar/latest/toastui-calendar.min.css"
/>
<link
  rel="stylesheet"
  href="https://uicdn.toast.com/tui.date-picker/latest/tui-date-picker.css"
/>
<link
  rel="stylesheet"
  href="https://uicdn.toast.com/tui.time-picker/latest/tui-time-picker.css"
/>
<script src="https://uicdn.toast.com/calendar/latest/toastui-calendar.ie11.min.js"></script>
<script src="https://uicdn.toast.com/tui.time-picker/latest/tui-time-picker.min.js"></script>
<script src="https://uicdn.toast.com/tui.date-picker/latest/tui-date-picker.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.3/moment.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/chance/1.1.8/chance.min.js"></script>
<script>
  const Calendar = tui.Calendar;

  const container = document.getElementById("calendar");
  const options = {
    defaultView: "week", // ì›”ë³„ ë·°ë¡œ ì„¤ì •
    taskView: true, // í•  ì¼ ëª©ë¡ í™œì„±í™”
    scheduleView: true, // ì¼ì • ëª©ë¡ í™œì„±í™”
    // calendars: MOCK_CALENDARS,
    useFormPopup: true,
    useDetailPopup: true,
    template: {
      monthDayName: function (dayname) {
        // ì—¬ê¸°ì—ì„œëŠ” ë‹¨ìˆœíˆ ìš”ì¼ëª…ì„ ë°˜í™˜í•©ë‹ˆë‹¤.
        return (
          '<span class="calendar-week-dayname">' + dayname.label + "</span>"
        );
      },
      monthDate: function (date) {
        // í˜„ì¬ ë‚ ì§œì™€ ë‹¬ë ¥ì˜ ë‚ ì§œê°€ ì¼ì¹˜í•˜ëŠ”ì§€ í™•ì¸
        var today = tui.Calendar.Date.today();
        var className = today.equals(date) ? "calendar-today" : "";
        return '<span class="' + className + '">' + date.getDate() + "</span>";
      },
      popupIsAllday: function () {
        return "All day?";
      },
      popupStateFree: function () {
        return "ğŸï¸ Free";
      },
      popupStateBusy: function () {
        return "ğŸ”¥ Busy";
      },
      titlePlaceholder: function () {
        return "Enter title";
      },
      locationPlaceholder: function () {
        return "Enter location";
      },
      startDatePlaceholder: function () {
        return "Start date";
      },
      endDatePlaceholder: function () {
        return "End date";
      },
      popupSave: function () {
        return "Add Event";
      },
      popupUpdate: function () {
        return "Update Event";
      },
      popupEdit: function () {
        return "Modify";
      },
      popupDelete: function () {
        return "Remove";
      },
      popupDetailTitle: function (data) {
        return "Detail of " + data.title;
      },
    },
    timezone: {
      usageStatistics: false,
      zones: [
        {
          timezoneName: "Asia/Seoul",
          displayLabel: "Seoul",
          tooltip: "UTC+9:00",
        },
        {
          timezoneName: "America/New_York",
          displayLabel: "NY",
          tooltip: "UTC-04:00",
        },
      ],
    },
    calendars: [
      {
        id: "cal1",
        name: "Todo",
        backgroundColor: "#1973B7",
      },
      {
        id: "cal2",
        name: "ì™„ë£Œ",
        backgroundColor: "#3CD071",
      },
      {
        id: "cal3",
        name: "ì§„í–‰ì¤‘",
        backgroundColor: "#F96C33",
      },
    ],
  };

  const calendar = new Calendar(container, options);

  calendar.createEvents([
    {
      id: "event1",
      calendarId: "cal2",
      title: "ì£¼ê°„ íšŒì˜",
      start: "2024-04-06T09:00:00",
      end: "2024-04-06T10:00:00",
    },
    {
      id: "event2",
      calendarId: "cal1",
      title: "ì ì‹¬ ì•½ì†",
      start: "2024-04-06T12:00:00",
      end: "2024-04-06T13:00:00",
    },
    {
      id: "event3",
      calendarId: "cal3",
      title: "íœ´ê°€",
      start: "2024-04-06",
      end: "2024-04-06",
      isAllday: true,
      category: "allday",
    },
  ]);

  calendar.setDate(new Date());

  // calendar.setOptions({
  //   useFormPopup: true,
  //   useDetailPopup: true,
  // });

  calendar.render();

  let now_view_time = "week";

  // ì›”ê°„ ë·°ë¡œ ë³€ê²½
  // ì›”ê°„ ë·°ë¡œ ë³€ê²½í•˜ëŠ” ë²„íŠ¼
  const button_monthly = document.getElementById("monthly");
  button_monthly.addEventListener("click", function () {
    calendar.changeView("month");
    now_view_time = "month";
    calendar.setDate(new Date());
    updateViewToday();
  });

  // ì£¼ê°„ ë·°ë¡œ ë³€ê²½í•˜ëŠ” ë²„íŠ¼
  const button_weekly = document.getElementById("weekly");
  button_weekly.addEventListener("click", function () {
    calendar.changeView("week");
    now_view_time = "week";
    calendar.setDate(new Date());
    updateViewToday();
  });

  // ì¼ê°„ ë·°ë¡œ ë³€ê²½í•˜ëŠ” ë²„íŠ¼
  const button_daily = document.getElementById("daily");
  button_daily.addEventListener("click", function () {
    calendar.changeView("day");
    now_view_time = "day";
    calendar.setDate(new Date());
    updateViewToday();
  });

  const btn_date_previous = document.getElementById("date_previous");
  btn_date_previous.addEventListener("click", function () {
    const currentDate = calendar.getDate();
    if (now_view_time == "day") {
      const prevDay = new Date(currentDate);
      prevDay.setDate(prevDay.getDate() - 1);
      calendar.setDate(prevDay);
    } else if (now_view_time == "week") {
      const prevWeek = new Date(currentDate);
      prevWeek.setDate(prevWeek.getDate() - 7);
      calendar.setDate(prevWeek);
    } else if (now_view_time == "month") {
      const prevMonth = new Date(currentDate);
      prevMonth.setMonth(prevMonth.getMonth() - 1);
      calendar.setDate(prevMonth);
    }
    updateViewToday();
  });

  const btn_date_next = document.getElementById("date_next");
  btn_date_next.addEventListener("click", function () {
    const currentDate = calendar.getDate();
    if (now_view_time == "day") {
      const nextDay = new Date(currentDate);
      nextDay.setDate(nextDay.getDate() + 1);
      calendar.setDate(nextDay);
    } else if (now_view_time == "week") {
      const nextWeek = new Date(currentDate);
      nextWeek.setDate(nextWeek.getDate() + 7);
      calendar.setDate(nextWeek);
    } else if (now_view_time == "month") {
      const nextMonth = new Date(currentDate);
      nextMonth.setMonth(nextMonth.getMonth() + 1);
      calendar.setDate(nextMonth);
    }
    updateViewToday();
  });

  // ë‹¬ë ¥ì˜ í˜„ì¬ ë‚ ì§œë¥¼ ê°€ì ¸ì™€ì„œ YYYY-MM-DD í˜•ì‹ì˜ ë¬¸ìì—´ë¡œ ë³€í™˜í•˜ëŠ” í•¨ìˆ˜
  function getCurrentDateString(calendar) {
    const currentDate = calendar.getDate();
    const year = currentDate.getFullYear();
    const month = String(currentDate.getMonth() + 1).padStart(2, "0"); // MM í˜•ì‹ìœ¼ë¡œ ë§Œë“¤ê¸°
    const day = String(currentDate.getDate()).padStart(2, "0"); // DD í˜•ì‹ìœ¼ë¡œ ë§Œë“¤ê¸°
    return `${year}-${month}-${day}`;
  }

  // ê° ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ë‚´ì—ì„œ ë‹¬ë ¥ì˜ ë‚ ì§œê°€ ë³€ê²½ë  ë•Œë§ˆë‹¤ #view_today ì—…ë°ì´íŠ¸
  function updateViewToday() {
    document.getElementById("view_today").textContent =
      getCurrentDateString(calendar);
  }

  function displayEvents() {
    var events = generateRandomEvents(
      cal.getViewName(),
      cal.getDateRangeStart(),
      cal.getDateRangeEnd()
    );
    cal.clear();
    cal.createEvents(events);
  }

  function displayRenderRange() {
    var viewName = cal.getViewName();

    range.textContent = getNavbarRange(
      cal.getDateRangeStart(),
      cal.getDateRangeEnd(),
      viewName
    );
  }

  todayButton.addEventListener("click", function () {
    cal.today();
    displayEvents();
    displayRenderRange();
  });
  prevButton.addEventListener("click", function () {
    cal.prev();
    displayEvents();
    displayRenderRange();
  });
  nextButton.addEventListener("click", function () {
    cal.next();
    displayEvents();
    displayRenderRange();
  });

  displayEvents();
  displayRenderRange();
</script>

{% endblock %}
